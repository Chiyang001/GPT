<!DOCTYPE html>
<html>
<head>
    <title>æ‰«é›·æ¸¸æˆ</title>
    <style>
        .board {
            display: grid;
            grid-template-columns: repeat(10, 30px);
        }

        .cell {
            width: 30px;
            height: 30px;
            text-align: center;
            border: 1px solid #ccc;
            cursor: pointer;
            user-select: none;
        }

        .cell.revealed {
            background-color: #eee;
            cursor: default;
        }
    </style>
</head>
<body>
    <h1>æ‰«é›·æ¸¸æˆ</h1>
    <div id="board" class="board"></div>

    <script>
        const board = document.getElementById("board");
        const numRows = 10;
        const numCols = 10;
        const numMines = 20;
        let mineLocations = [];
        let revealedCells = new Array(numRows).fill([]).map(() => new Array(numCols).fill(false));

        // ç”Ÿæˆé›·çš„éšæœºä½ç½®
        function generateMines() {
            mineLocations = [];
            while (mineLocations.length < numMines) {
                const row = Math.floor(Math.random() * numRows);
                const col = Math.floor(Math.random() * numCols);
                if (!mineLocations.some(loc => loc[0] === row && loc[1] === col)) {
                    mineLocations.push([row, col]);
                }
            }
        }

        // åˆ¤æ–­æ ¼å­æ˜¯å¦åŒ…å«é›·
        function hasMine(row, col) {
            return mineLocations.some(loc => loc[0] === row && loc[1] === col);
        }

        // è®¡ç®—å‘¨å›´çš„é›·çš„æ•°é‡
        function countSurroundingMines(row, col) {
            let count = 0;
            for (let r = -1; r <= 1; r++) {
                for (let c = -1; c <= 1; c++) {
                    const newRow = row + r;
                    const newCol = col + c;
                    if (newRow >= 0 && newRow < numRows && newCol >= 0 && newCol < numCols && hasMine(newRow, newCol)) {
                        count++;
                    }
                }
            }
            return count;
        }

        // æ­å¼€æ ¼å­
        function revealCell(row, col) {
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            if (revealedCells[row][col]) return;
            revealedCells[row][col] = true;
            cell.classList.add("revealed");
            if (hasMine(row, col)) {
                // æ¸¸æˆç»“æŸï¼Œæ˜¾ç¤ºæ‰€æœ‰é›·
                cell.textContent = "ğŸ’£";
                alert("æ¸¸æˆç»“æŸï¼Œä½ è¸©åˆ°äº†åœ°é›·ï¼");
                // é‡ç½®æ¸¸æˆ
                resetGame();
            } else {
                const minesNearby = countSurroundingMines(row, col);
                if (minesNearby > 0) {
                    cell.textContent = minesNearby;
                } else {
                    // é€’å½’å±•å¼€å‘¨å›´çš„ç©ºç™½æ ¼å­
                    for (let r = -1; r <= 1; r++) {
                        for (let c = -1; c <= 1; c++) {
                            const newRow = row + r;
                            const newCol = col + c;
                            if (newRow >= 0 && newRow < numRows && newCol >= 0 && newCol < numCols) {
                                revealCell(newRow, newCol);
                            }
                        }
                    }
                }
            }
        }

        // å¤„ç†ç‚¹å‡»æ ¼å­äº‹ä»¶
        function handleCellClick(event) {
            const cell = event.target;
            const row = parseInt(cell.getAttribute("data-row"));
            const col = parseInt(cell.getAttribute("data-col"));
            revealCell(row, col);
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            board.innerHTML = '';
            generateMines();
            revealedCells = new Array(numRows).fill([]).map(() => new Array(numCols).fill(false));
            createBoard();
        }

        // åˆ›å»ºæ¸¸æˆæ¿
        function createBoard() {
            for (let row = 0; row < numRows; row++) {
                for (let col = 0; col < numCols; col++) {
                    const cell = document.createElement("div");
                    cell.className = "cell";
                    cell.setAttribute("data-row", row);
                    cell.setAttribute("data-col", col);
                    cell.addEventListener("click", handleCellClick);
                    board.appendChild(cell);
                }
            }
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        resetGame();
    </script>
</body>
</html>
